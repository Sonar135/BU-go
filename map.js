const buildings=[
  {
    name:"Ameyo",
    image:"images/2022-11-15.jpg",
    coordinates:{
        latitude:"6.895030345896131",
        longitude:"3.7250587786492497"
    },
},

{
    name:'Queen Esther',
    image:"images/2018-07-31.jpg",
    coordinates:{
        latitude:"6.893354076307076",
        longitude:"3.7242952884990785"
    },
},


{
    name:"FAD",
    image:"images/fad.jpg",
    coordinates:{
        latitude:"6.8938551248289395",
        longitude:"3.724757133980804"
    },
},

{
    name:"Crystal",
    image:"images/WhatsApp Image 2025-01-20 at 19.31.39.jpeg",
    coordinates:{
        latitude:"6.892606765688201",
        longitude:"3.728013768174291"
    },
},


{
    name:"Platinum",
    image:"images/2017-06-04.jpg",
    coordinates:{
        latitude:"6.891898667331963",
        longitude:"3.7274856946267096"
    },
},


{
    name:"Ogden",
    image:"images/WhatsApp Image 2025-01-20 at 19.30.39.jpeg",
    coordinates:{
        latitude:"6.893204798859399",
        longitude:"3.7267069301270497"
    },
},


{
    name:"Havilah Gold",
    image:"images/havilah.jpg",
    coordinates:{
        latitude:"6.894934536100923",
        longitude:" 3.7260806996710825"
    },
},


{
  name:"Sapphire",
  image:"images/WhatsApp Image 2025-01-20 at 13.31.27.jpeg",
  coordinates:{
      latitude:"6.8914392",
      longitude:"3.7263655"
  },
},

{
name:"White",
image:"images/2018-11-23.jpg",
coordinates:{
    latitude:"6.893796419854033",
    longitude:"3.726307960727902"
},
},


{
name:"Diamond",
image:"images/WhatsApp Image 2025-01-20 at 19.31.40.jpeg",
coordinates:{
    latitude:"6.89154295890297",
    longitude:"3.7274378052376718"
},
},

{
name:"Nyberg",
image:"images/nyberg.jpg",
coordinates:{
    latitude:"6.892612513800621",
    longitude:"3.7254955154433476"
},
},


{
  name:"Samuel Akande",
  image:"images/2018-07-08.jpg",
  coordinates:{
      latitude:"6.894150538061167",
      longitude:"3.7235165322496346"
  },
},


{
  name:"Neal wilson",
  image:"images/wilson.jpg",
  coordinates:{
      latitude:"6.893551542017954",
      longitude:"3.7213153832225165"
  },
},

{
  name:"winslow",
  image:"images/2021-07-03.jpg",
  coordinates:{
      latitude:"6.893929261765801",
      longitude:"3.72175869916458"
  },
},

{
  name:"emerald",
  image:"images/WhatsApp Image 2025-01-20 at 13.29.00.jpeg",
  coordinates:{
      latitude:"6.8936647",
      longitude:"3.7198149"
  },
},

{
  name:"gideon",
  image:"images/gideon.jpg",
  coordinates:{
      latitude:"6.894552441711924",
      longitude:"3.722331661846355"
  },
},

{
  name:"bethel",
  image:"images/bethel.jpg",
  coordinates:{
      latitude:"6.894524972387451",
      longitude:"3.7231185567621097"
  },
},


{
  name:"welch",
  image:"images/welch.jpg",
  coordinates:{
      latitude:"6.8913045443968",
      longitude:"3.7217132667544566"
  },
},


{
  name:"nelson mandela",
  image:"images/mandela.jpg",
  coordinates:{
      latitude:"6.893605386498164",
      longitude:"3.72306544464822"
  },
},

{
  name:"topaz",
  image:"images/WhatsApp Image 2025-01-20 at 19.38.02.jpeg",
  coordinates:{
      latitude:"6.893767817468163",
      longitude:"3.720621690740852"
  },
},


{
  name:"adeleke",
  image:"images/adeleke.jpg",
  coordinates:{
      latitude:"6.8927832362599",
      longitude:"3.7210867566787056"
  },
},


{
  name:"busary",
  image:"images/WhatsApp Image 2025-01-20 at 19.44.06.jpeg",
  coordinates:{
      latitude:"6.890125898004287",
      longitude:"3.7229927134898433"
  },
},


{
  name:"entrepreneurship",
  image:"images/WhatsApp Image 2025-01-20 at 14.00.51.jpeg",
  coordinates:{
      latitude:"6.8891578",
      longitude:"3.7263045"
  },
},


{
  name:"farm house",
  image:"images/WhatsApp Image 2025-01-20 at 14.41.51.jpeg",
  coordinates:{
      latitude:"6.8902486",
      longitude:"3.7259833"
  },
},


{
  name:"bumu",
  image:"images/WhatsApp Image 2025-01-20 at 14.17.48.jpeg",
  coordinates:{
      latitude:"6.892521",
      longitude:"3.720413"
  },
},


{
  name:"registry",
  image:"images/WhatsApp Image 2025-01-20 at 19.41.47.jpeg",
  coordinates:{
      latitude:"6.889482832565852",
      longitude:"3.7223997255545282"
  },
},

{
  name:"alumi building",
  image:"images/WhatsApp Image 2025-01-20 at 19.37.15.jpeg",
  coordinates:{
      latitude:"6.892664413865216",
      longitude:"3.7205273643296155"
  },
},


{
  name:"security office",
  image:"",
  coordinates:{
     latitude:"6.890859461094672",
     longitude:"3.7225472078025525"
  },
},

{
  name:"nursing science",
  image:"images/WhatsApp Image 2025-01-20 at 19.34.14.jpeg",
  coordinates:{
      latitude:"6.8912225",
      longitude:"3.7227904"
  },
},

{
  name:"BBS",
  image:"images/bbs.png",
  coordinates:{
      latitude:"6.89072291334421",
      longitude:"3.7240046288794098"
  },
},


{
  name:"SAT",
  image:"images/WhatsApp Image 2025-01-20 at 19.43.29.jpeg",
  coordinates:{
      latitude:"6.888844522542642",
      longitude:"3.7229143071147894"
  },
},

{
  name:"chemistry lab",
  image:"",
  coordinates:{
      latitude:"6.888053100437225",
      longitude:"3.72295837214855"
  },
},

{
  name:"engineering sch",
  image:"images/WhatsApp Image 2025-01-20 at 14.00.52.jpeg",
  coordinates:{
      latitude:"6.8895027",
      longitude:"3.7240833"
  },
},

{
  name:"EAH",
  image:"images/WhatsApp Image 2025-01-20 at 19.36.43.jpeg",
  coordinates:{
      latitude:"6.890244297687223",
      longitude:"3.7207006961518774"
  },
},

{
  name:"new horizon",
  image:"images/WhatsApp Image 2025-01-20 at 19.44.08.jpeg",
  coordinates:{
      latitude:"6.890481261704027",
      longitude:"3.723260912472078"
  },
},

{
  name:"600 seaters",
  image:"",
  coordinates:{
      latitude:"6.89143472387291",
      longitude:"3.7168539244662586"
  },
},

{
  name:"bucodel",
  image:"images/WhatsApp Image 2025-01-20 at 14.01.43.jpeg",
  coordinates:{
      latitude:"6.8917534",
      longitude:"3.7231606"
  },
},


{
  name:"A&E",
  image:"images/WhatsApp Image 2025-01-20 at 14.33.37.jpeg",
  coordinates:{
      latitude:"6.8918676",
      longitude:"3.7185995"
  },
},

{
  name:"lab test",
  image:"images/WhatsApp Image 2025-01-20 at 14.33.38 (1).jpeg",
  coordinates:{
      latitude:"6.891351",
      longitude:"3.718248"
  },
},

{
  name:"cardiac center",
  image:"images/WhatsApp Image 2025-01-20 at 14.33.38.jpeg",
  coordinates:{
      latitude:"6.8919768",
      longitude:"3.7185375"
  },
},

{
  name:"outpatient clinic",
  image:"",
  coordinates:{
      latitude:"6.892253",
      longitude:"3.718209"
  },
},


{
  name:"student clinic",
  image:"images/WhatsApp Image 2025-01-20 at 19.35.04.jpeg",
  coordinates:{
     latitude:"6.890859461094672",
      longitude:"3.7225472078025525"
  },
},

{
  name:"amphitheatre",
  image:"images/WhatsApp Image 2025-01-20 at 19.34.47.jpeg",
  coordinates:{
      latitude:"6.890859461094672",
      longitude:"3.7225472078025525"
  },
},


{
  name:"busa",
  image:"images/WhatsApp Image 2025-01-20 at 19.33.28.jpeg",
  coordinates:{
      latitude:"6.8920889",
      longitude:"3.7238201"
  },
},


{
  name:"main gate",
  image:"images/WhatsApp Image 2025-01-20 at 14.01.30.jpeg",
  coordinates:{
      latitude:"6.8888872",
      longitude:"3.7197522"
  },
},


{
  name:"basketball court",
  image:"",
  coordinates:{
      latitude:"6.8939960750281815",
      longitude:"3.7284691330356745"
  },
},


{
  name:"superstore",
  image:"images/babrite.jpg",
  coordinates:{
      latitude:"6.891164099421291",
      longitude:"3.720359600755251"
  },
},


{
  name:"jumia hub",
  image:"",
  coordinates:{
      latitude:"6.891259240532254",
      longitude:"3.7208967137517277"
  },
},


{
  name:"banking area",
  image:"images/WhatsApp Image 2025-01-20 at 19.36.03.jpeg",
  coordinates:{
      latitude:"6.890894160905001",
      longitude:"3.7204693632964685"
  },
},

{
  name:"university library",
  image:"images/library.webp",
  coordinates:{
      latitude:"6.892345727597431",
      longitude:"3.7222057678081777"
  },
},

{
  name:"DHL",
  image:"images/WhatsApp Image 2025-01-20 at 14.38.30.jpeg",
  coordinates:{
      latitude:"6.8891052",
      longitude:"3.7209437"
  },
},

{
  name:"BGH / guest house",
  image:"images/bgh.jpg",
  coordinates:{
      latitude:"6.890525437582436",
      longitude:"3.7201008562709257"
  },
},

{
  name:"stadium",
  image:"images/stadium.jpg",
  coordinates:{
      latitude:"6.894978114199844",
      longitude:"3.727161356692398"
  },
},

{
  name:"MSQ gate",
  image:"",
  coordinates:{
      latitude:"6.8957360",
      longitude:"3.7239401"
  },
},

{
  name:"andrews car park",
  image:"images/WhatsApp Image 2025-01-20 at 19.41.44.jpeg",
  coordinates:{
      latitude:"6.8892871041690915",
      longitude:"3.7208637665726645"
  },
},

{
  name:"cafeteria",
  image:"images/caf.jpg",
  coordinates:{
      latitude:"6.89278985544793",
      longitude:"3.7237406440420293"
  },
},

{
  name:"SAT bookshop",
  image:"images/WhatsApp Image 2025-01-20 at 14.01.31.jpeg",
  coordinates:{
      latitude:"6.8888173",
      longitude:"3.7224635"
  },
},

{
  name:"pioneer chapel",
  image:"images/WhatsApp Image 2025-01-20 at 19.41.46.jpeg",
  coordinates:{
      latitude:"6.889791275931557",
      longitude:"3.719890517431272"
  },
},

{
  name:"youth chapel",
  image:"images/WhatsApp Image 2025-01-20 at 14.38.31.jpeg",
  coordinates:{
      latitude:"6.8898382",
      longitude:"3.7194048"
  },
},




]









buildings.forEach(building=>{
  document.querySelector(".locations ul").innerHTML+=`
      <li><i class="fa-solid fa-location-dot"></i>${building.name}</li>
  `
})


let form=document.querySelector("#form")

let calc

const urlParams = new URLSearchParams(window.location.search);


const branch_lat = urlParams.get('v');
const branch_long = urlParams.get('q');

let lastDestination=null;


let vibe=document.querySelectorAll(".vibe");

vibe.forEach((vib, i)=>{
  setTimeout(()=>{
    vib.classList.add("vibe_rise")
  }, i*100)
  
})






// console.log(`latitude: ${branch_lat} and longitude: ${branch_long}`)

const input = document.getElementById('destination');
const locations = document.querySelector(".locations")
let items=document.querySelectorAll(".locations ul li")






function initMap() {
  
    // Coordinates for Babcock University
    const babcockUniversity = { lat: 6.893956, lng: 3.718715 };
    
    const mockLocation = { lat:6.892839277599381, lng:3.7238590597861876 }; 
  
    // Define a bounding box around Babcock University
    const bounds = {
      north: 6.895978114199844, 
      south: 6.882, 
      east: 3.730, 
      west: 3.7158957026299593 
    };
      // latitude:"",
      //  longitude:"3.727161356692398"
    // Map options
    const mapOptions = {
        
      zoom: 19, // Suitable zoom level for the campus
      center: mockLocation, // Center the map on Babcock University
      restriction: {
        latLngBounds: bounds, // Restrict map to the bounding box
        strictBounds: false   // Allow some panning outside bounds before snapping back
      },
    zoomControl: false,         // Disable zoom controls
    mapTypeControl: false,      // Disable map type (satellite/terrain) controls
    streetViewControl: false,   // Disable Street View controls
    fullscreenControl: false,
    disableDefaultUI: true,
    gestureHandling: "greedy" ,
    };


  
    // Create the map
    const map = new google.maps.Map(document.getElementById('map'), mapOptions);



    map.setOptions({ scrollwheel: false });
  
    // Add a marker for Babcock University
    new google.maps.Marker({
      position: mockLocation,
      map: map,
      title: 'my location'
    });


    // setTimeout(()=>{

    //   buildings.forEach(building=>{
    //     new google.maps.Marker({
    //       position: { lat: parseFloat(building.coordinates.latitude) ,  lng: parseFloat( building.coordinates.longitude) },
    //       map: map,
    //       icon: {
    //         url: building.image,  // Path to your custom image
    //         scaledSize: new google.maps.Size(30, 30)  // Resize the image (optional)
    //       }
    //     });
    //   })
    // }, 8000)

 



    const directionsService = new google.maps.DirectionsService();
    const directionsRenderer = new google.maps.DirectionsRenderer();
    directionsRenderer.setMap(map);



    google.maps.event.addListenerOnce(map, 'idle', () => {
      if(branch_lat!=="" || branch_long!==""){
        document.querySelector("#coords").value=`${branch_lat}, ${branch_long}`
        const submitEvent = new Event("submit", { bubbles: true, cancelable: true  });
      
    
        form.dispatchEvent(submitEvent);
      }
    });


    

   document.querySelector("#satellite").addEventListener('click', () => {


    if(document.querySelector("#satellite").classList.contains("selected")){
      document.querySelector("#satellite").classList.remove("selected")
      map.setMapTypeId('roadmap');
    }

    else{
      document.querySelector("#satellite").classList.add("selected")

      map.setMapTypeId('hybrid');
    }


 
  });

  document.querySelector("#plus").addEventListener('click', () => {
    map.setZoom(map.getZoom() + 1); // Zoom in
  });

  document.querySelector("#minus").addEventListener('click', () => {
    map.setZoom(map.getZoom() - 1); // Zoom in
  });




  document.querySelector("#show_location").addEventListener('click', () => {
    map.panTo(mockLocation); // Pan to the mock location
    // map.setZoom(16); // Optionally set a fixed zoom level
  });


    input.addEventListener("input", () => {
      if (input.value.trim() !== "") {
        let matchFound = false; 
    
        items.forEach((item, i) => {
          if (item.textContent.toLowerCase().includes(input.value.trim().toLowerCase())) {

  
              
              items[i].style.display = "flex"; 
           
            
            matchFound = true; 
          } else {
            items[i].style.display = "none"; 
          }
        });
    
        if (matchFound) {
          locations.classList.add("active"); 
        } else {
          locations.classList.remove("active"); 
        }
    
      } else {

        locations.classList.remove("active");
        items.forEach((item) => {
          item.style.display = "none";
        });
      }
    });



    items.forEach((item, i)=>{
      item.addEventListener("click", ()=>{
        input.value=buildings[i].name
        document.querySelector("#coords").value=`${buildings[i].coordinates.latitude}, ${buildings[i].coordinates.longitude}`

        const submitEvent = new Event("submit", { bubbles: true, cancelable: true  });


        form.dispatchEvent(submitEvent);
        locations.classList.remove("active"); 
      })
    })



    form.addEventListener("submit", (event) => {
      event.preventDefault(); // Prevent default form submission




      
     
        const form_data= new FormData(form)
    
        let get_coords=form_data.get("coords")

        const coordinateMatch = get_coords.match(/^(-?\d+(\.\d+)?),\s*(-?\d+(\.\d+)?)$/);
        if (coordinateMatch) {
          const lat = parseFloat(coordinateMatch[1]);
          const lng = parseFloat(coordinateMatch[3]);

          calculateRoute({ lat, lng })
         

    
          
        

        }
    
    });
    




    



    function calculateRoute(destination) {
      lastDestination = destination;
      document.querySelector(".loading").classList.add("show")
      directionsService.route(
        {
          origin: mockLocation,
          destination: destination,
          travelMode: google.maps.TravelMode.WALKING,
          provideRouteAlternatives: true 
        },
        (response, status) => {
          document.querySelector(".loading").classList.remove("show")

          document.querySelector(".area").classList.remove("area_active")
          void document.querySelector(".area").offsetWidth;
          document.querySelector(".area").classList.add("area_active")

        

          let coords=document.querySelector("#coords").value
          let coord_match= coords.match(/^(-?\d+(\.\d+)?),\s*(-?\d+(\.\d+)?)$/);

          let lat = parseFloat(coord_match[1]);
          let lng = parseFloat(coord_match[3]);

          
          

          buildings.forEach(building=>{
            if(building.coordinates.latitude==lat && building.coordinates.longitude==lng){
              document.querySelector(".area h1").textContent=building.name
            }
          })

          input.value=""

          window.scrollBy({
            top:100
          })
          if (status === google.maps.DirectionsStatus.OK) {
            
            directionsRenderer.setDirections(response);
          } else {
            alert('Directions request failed due to: ' + status);
          }
        }
      );
    }

  }
  







  navigator.geolocation.getCurrentPosition((position) => {
    const userLocation = {
      lat: position.coords.latitude,
      lng: position.coords.longitude
    };
  

  });
  


